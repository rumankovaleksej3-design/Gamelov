<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>ChatNet ‚Äî –í—Ö–æ–¥</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body { margin:0;font-family:Arial;background:#0f172a;color:white }
.page { display:none;padding:20px }
.page.active { display:block }
input, button {
  width:100%;
  padding:12px;
  margin-top:10px;
  border-radius:8px;
  border:none;
}
button { background:#4caf50;color:white;font-size:16px }
.chat-box {
  height:300px;overflow:auto;
  background:#020617;padding:10px;border-radius:10px;
}
.msg { margin-bottom:6px }
</style>
</head>

<body>

<!-- AUTH -->
<div id="auth" class="page active">
  <h2>–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
  <button onclick="login()">–í–æ–π—Ç–∏</button>
  <button onclick="register()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
</div>

<!-- CHAT -->
<div id="chat" class="page">
  <h2>–û–Ω–ª–∞–π–Ω —á–∞—Ç</h2>
  <div class="chat-box" id="messages"></div>
  <input id="msg" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ">
  <button onclick="send()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  <button onclick="logout()">–í—ã–π—Ç–∏</button>
</div>

<script>
// üî• –í–°–¢–ê–í–¨ –°–Æ–î–ê –°–í–û–ô CONFIG
const firebaseConfig = {
  apiKey: "API_KEY",
  authDomain: "PROJECT.firebaseapp.com",
  projectId: "PROJECT",
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

auth.onAuthStateChanged(user => {
  if (user) {
    authPage(false);
    loadMessages();
  } else {
    authPage(true);
  }
});

function authPage(showAuth) {
  document.getElementById("auth").classList.toggle("active", showAuth);
  document.getElementById("chat").classList.toggle("active", !showAuth);
}

function register() {
  auth.createUserWithEmailAndPassword(email.value, password.value)
  .catch(e => alert(e.message));
}

function login() {
  auth.signInWithEmailAndPassword(email.value, password.value)
  .catch(e => alert(e.message));
}

function logout() {
  auth.signOut();
}

function send() {
  if (!msg.value) return;
  db.collection("messages").add({
    user: auth.currentUser.email,
    text: msg.value,
    time: Date.now()
  });
  msg.value = "";
}

function loadMessages() {
  db.collection("messages").orderBy("time")
  .onSnapshot(snap => {
    messages.innerHTML = "";
    snap.forEach(doc => {
      const d = doc.data();
      const div = document.createElement("div");
      div.className = "msg";
      div.innerText = d.user + ": " + d.text;
      messages.appendChild(div);
    });
  });
}
</script>

</body><script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyDioAafJRuJ4eMGK25-RsQb8M95CWlb1BY",
    authDomain: "chatnet-2a748.firebaseapp.com",
    projectId: "chatnet-2a748",
    storageBucket: "chatnet-2a748.firebasestorage.app",
    messagingSenderId: "62156425194",
    appId: "1:62156425194:web:580b1c319a6cf7268f1493"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
</script>
</html>
